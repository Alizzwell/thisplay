/* 2016-10-14 */ !function(window){"use strict";window.thisplay=window.thisplay||{}}(window),function(thisplay,d3){"use strict";function Chart(target){var svg=d3.select(target).append("g").attr("class","thisplay-chart").attr("transform","translate(25, 25)"),width=300,height=200,data=[],h=[],zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),this.svg=svg,this.width=width,this.height=height,this.data=data,this.h=h}Chart.prototype.init=function(size){this.data=new Array(size),this.h=new Array(size),this.data.fill(0),this.h.fill(0);var x=d3.scaleBand().range([0,this.width]).padding(.1),y=d3.scaleLinear().range([this.height,0]);x.domain(this.data.map(function(d,i){return i})),this.x=x,this.y=y,this.redrawChart()},Chart.prototype.setData=function(idx,val){var that=this;this.data[idx]=val,this.y.domain([0,d3.max(this.data,function(d){return d})]),this.svg.selectAll(".bar").data(this.data).transition().duration(300).attr("x",function(d,i){return that.x(i)}).attr("y",function(d){return that.y(d)}).attr("height",function(d){return that.height-that.y(d)})},Chart.prototype.swap=function(i,j){var that=this,swap_duration=300,tmp=this.data[i];this.data[i]=this.data[j],this.data[j]=tmp,tmp=this.h[i],this.h[i]=this.h[j],this.h[j]=tmp,this.svg.selectAll(".bar").style("fill",function(d,idx){return idx==i||idx==j?"orchid":that.h[idx]?"red":void 0}).transition().duration(swap_duration).attr("x",function(d,idx){return idx==i?that.x(j):idx==j?that.x(i):that.x(idx)}),setTimeout(function(){that.redrawChart()},swap_duration)},Chart.prototype.clear=function(){this.svg.select(".axis").remove(),this.svg.selectAll(".bar").remove()},Chart.prototype.highlight=function(idx){this.h[idx]=1,this.reColoring()},Chart.prototype.unhighlight=function(idx){void 0===idx?this.h.fill(0):this.h[idx]=0,this.reColoring()},Chart.prototype.redrawChart=function(){var that=this;this.clear(),this.svg.append("g").attr("class","axis").attr("transform","translate(0,"+this.height+")").call(d3.axisBottom(this.x)),this.svg.selectAll(".bar").data(this.data).enter().append("rect").attr("class","bar").attr("x",function(d,i){return that.x(i)}).attr("width",this.x.bandwidth()).attr("y",function(d){return that.y(d)}).attr("height",function(d){return that.height-that.y(d)}),this.reColoring()},Chart.prototype.reColoring=function(){var self=this,bar=this.svg.selectAll(".bar");bar.data(this.data).style("fill",function(d,i){if(1===self.h[i])return"red"})},thisplay.Chart=Chart}(thisplay,d3),function(thisplay,d3){"use strict";function Graph(target){var svg=d3.select(target).append("g").attr("class","thisplay-graph").attr("transform","translate(25, 25)"),svgLink=svg.append("g").attr("class","linkGroup"),svgNode=svg.append("g").attr("class","nodeGroup"),zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom);var width=500,height=500,radius=50,nodes=[],links=[],forceManyBody=d3.forceManyBody().strength(-3e3).theta(.9).distanceMin(100).distanceMax(1e3),forceLink=d3.forceLink();forceLink.links(links).distance(500).strength(-2e3).iterations(.8);var forceCollide=d3.forceCollide().radius(radius).strength(.9).iterations(1),force=d3.forceSimulation();force.nodes(nodes).force("charge",forceManyBody).force("link",forceLink).force("center",d3.forceCenter(width/2,height/2)).force("collide",forceCollide).force("x",d3.forceX().strength(.05)).force("y",d3.forceY().strength(.05)).alphaMin(.2).alphaDecay(.1).velocityDecay(.4).on("tick",function(){svgNode.selectAll(".node").attr("transform",function(d){return"translate("+[d.x,d.y]+")"}).attr("x",function(d){return d.x}).attr("y",function(d){return d.y}),svgNode.selectAll(".nodetext").attr("transform",function(d){return"translate("+[d.x,d.y+15]+")"}),svgLink.selectAll(".link").attr("d",function(d){return"true"===d.is_directed?drawDirectedLine(d):drawUnDirectedLine(d)}),svgLink.selectAll(".linktext").attr("transform",function(d){return"true"===d.is_directed?drawDirectedText(d):drawUnDirectedText(d)})});var drawUnDirectedLine=function(d){var sx=d.source.getAttribute("x"),sy=d.source.getAttribute("y"),tx=d.target.getAttribute("x"),ty=d.target.getAttribute("y");return"M"+sx+","+sy+"L"+tx+","+ty},drawDirectedLine=function(d){var sx=d.source.getAttribute("x"),sy=d.source.getAttribute("y"),tx=d.target.getAttribute("x"),ty=d.target.getAttribute("y"),dx=tx-sx,dy=ty-sy,dr=Math.sqrt(dx*dx+dy*dy),theta=Math.atan2(dy,dx)+.1,d90=Math.PI/2,dtxs=tx-1.43*radius*Math.cos(theta),dtys=ty-1.43*radius*Math.sin(theta),val1=3.5,val2=8.5;return"M"+sx+","+sy+"A"+1.5*dr+","+1.5*dr+" 0 0 1,"+dtxs+","+dtys+"A"+1.5*dr+","+1.5*dr+" 0 0 0,"+sx+","+sy+"M"+dtxs+","+dtys+"l"+(val1*Math.cos(d90-theta)-val2*Math.cos(theta))+","+(-val1*Math.sin(d90-theta)-val2*Math.sin(theta))+"L"+(dtxs-val1*Math.cos(d90-theta)-val2*Math.cos(theta))+","+(dtys+val1*Math.sin(d90-theta)-val2*Math.sin(theta))+"z"},drawDirectedText=function(d){var sx=d.source.getAttribute("x"),sy=d.source.getAttribute("y"),tx=d.target.getAttribute("x"),ty=d.target.getAttribute("y"),dx=tx-sx,dy=ty-sy,dr=Math.sqrt(dx*dx+dy*dy),theta=Math.atan2(dy,dx),d90=Math.PI/2,cx=tx-dr/2*Math.cos(theta),cy=ty-dr/2*Math.sin(theta);return"translate("+[cx+70*Math.cos(d90-theta),cy-70*Math.sin(d90-theta)]+")"},drawUnDirectedText=function(d){var sx=Number(d.source.getAttribute("x")),sy=Number(d.source.getAttribute("y")),tx=Number(d.target.getAttribute("x")),ty=Number(d.target.getAttribute("y")),dx=tx-sx,dy=ty-sy,theta=Math.atan2(dy,dx),d90=Math.PI/2;return"translate("+[(sx+tx)/2-45*Math.cos(d90-theta),(sy+ty)/2+45*Math.sin(d90-theta)]+")"};this.target=target,this.svg=svg,this.svgNode=svgNode,this.svgLink=svgLink,this.width=width,this.height=height,this.radius=radius,this.forceLink=forceLink,this.forceManyBody=forceManyBody,this.force=force,this.nodes=nodes,this.links=links}Graph.prototype.redraw=function(){function dragstarted(d){d3.event.active||that.force.alpha(.6).restart(),that.force.alpha(.6),d.fx=d.x,d.fy=d.y}function dragged(d){d.fx=d3.event.x,d.fy=d3.event.y}function dragended(d){d3.event.active||that.force.alphaTarget(.2),d.fx=null,d.fy=null}var that=this;this.svgLink.selectAll(".link").data(this.links).enter().insert("path").attr("class","link").attr("id",function(d){return d.id}).attr("is_directed",function(d){return d.is_directed}),this.svgLink.selectAll(".linktext").data(this.links).enter().insert("text").attr("class","linktext").attr("id",function(d){return"text"+d.id}).text(function(d){return d.value}),this.svgNode.selectAll(".node").data(this.nodes).enter().insert("circle").attr("class","node").attr("id",function(d){return d.id}).attr("r",this.radius).call(d3.drag().on("start",dragstarted).on("drag",dragged).on("end",dragended)),this.svgNode.selectAll(".nodetext").data(this.nodes).enter().insert("text").attr("class","nodetext").attr("id",function(d){return"text"+d.id}).text(function(d){return d.text}).call(d3.drag().on("start",dragstarted).on("drag",dragged).on("end",dragended))},Graph.prototype.makeNode=function(idx,text){if(null===this.svgNode.select("#node_"+idx).node()){var last=this.nodes.length-1;this.nodes.push({id:"node_"+idx,idx:idx,text:text,x:last<0?this.width/2:this.nodes[last].x,y:last<0?this.height/2:this.nodes[last].y})}else for(var i=0;i<this.nodes.length;i++)if(this.nodes[i].idx===idx){this.nodes[i].text=text,this.svgNode.select("#textnode_"+idx).text(text);break}this.force.nodes(this.nodes).alpha(1).restart(),this.redraw()},Graph.prototype.makeEdge=function(source,target,value,is_directed){var snode,tnode,tmp,edge=this.svgLink.select("#link_"+source+"_"+target).node();if(source>target&&"true"!==is_directed&&(tmp=source,source=target,target=tmp),snode=this.svgNode.select("#node_"+source).node(),tnode=this.svgNode.select("#node_"+target).node(),source==target);else if(null===snode||null===tnode);else if(null===edge)this.links.push({id:"link_"+source+"_"+target,source:snode,target:tnode,value:value,is_directed:is_directed});else for(var i=0;i<this.links.length;i++)if(this.links[i].id==="link_"+source+"_"+target){this.links[i].value=value,this.svgLink.select("#textlink_"+source+"_"+target).text(value);break}this.forceLink.links(this.links),this.force.alpha(1),this.force.restart(),this.redraw()},Graph.prototype.highlightNode=function(idx){var node=this.svg.select("#node_"+idx);null!==node.node()&&node.transition().duration(500).style("fill","#F0F")},Graph.prototype.highlightEdge=function(source,target){var edge=this.svg.select("#link_"+source+"_"+target),edge2=this.svg.select("#link_"+target+"_"+source);null!==edge2.node()&&"true"!==edge2.node().getAttribute("is_directed")&&edge2.transition().duration(500).style("stroke","black"),null!==edge.node()&&edge.transition().duration(500).style("stroke","black")},Graph.prototype.deleteEdge=function(source,target){var snode=this.svgNode.select("#node_"+source).node(),tnode=this.svgNode.select("#node_"+target).node();if(source!=target&&null!==snode&&null!==tnode){for(var i=0;i<this.links.length;i++)this.links[i].source==snode&&this.links[i].target==tnode?(console.log("1"),this.links.splice(i,1)):this.links[i].source==tnode&&this.links[i].target==snode&&"true"!==this.links[i].is_directed&&(console.log("2"),this.links.splice(i,1),this.svgLink.select("#link_"+target+"_"+source).remove(),this.svgLink.select("#textlink_"+target+"_"+source).remove());this.svgLink.select("#link_"+source+"_"+target).remove(),this.svgLink.select("#textlink_"+source+"_"+target).remove(),this.forceLink.links(this.links),this.force.alpha(1).restart(),this.redraw()}},Graph.prototype.deleteNode=function(idx){for(var i=0;i<this.nodes.length;i++)if(this.nodes[i].idx===idx){for(var j=0;j<this.nodes.length;j++)this.deleteEdge(idx,j),this.deleteEdge(j,idx);this.svgNode.select("#"+this.nodes[i].id).remove(),this.svgNode.select("#text"+this.nodes[i].id).remove(),this.nodes.splice(i,1)}this.force.nodes(this.nodes).alpha(1).restart(),this.redraw()},Graph.prototype.unHighlightNode=function(idx){var node=this.svg.select("#node_"+idx);void 0===idx?this.unHighlightNodeAll():null!==node.node()&&node.transition().duration(500).style("fill",this.default_node_color)},Graph.prototype.unHighlightEdge=function(source,target){var edge=this.svg.select("#link_"+source+"_"+target);void 0===source&&void 0===target?this.unHighlightEdgeAll():null!==edge.node()&&edge.transition().duration(500).style("stroke",this.default_link_color)},Graph.prototype.unHighlightNodeAll=function(){for(var i=0;i<this.nodes.length;i++)this.unHighlightNode(this.nodes[i].idx)},Graph.prototype.unHighlightEdgeAll=function(){for(var i=0;i<this.links.length;i++)this.svg.select("#"+this.links[i].id).transition().duration(500).style("stroke",this.default_link_color)},Graph.prototype.clear=function(){this.svg.selectAll(".node").remove(),this.svg.selectAll(".nodetext").remove(),this.svg.selectAll(".link").remove(),this.svg.selectAll(".linktext").remove(),this.nodes=[],this.links=[],this.redraw()},thisplay.Graph=Graph}(thisplay,d3),function(thisplay,d3){"use strict";function LinkedList(target){var svg=d3.select(target).append("g").attr("class","thisplay-linkedlist").attr("transform","translate(25, 25)"),width=300,height=200,data=["head"],cur=0,zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),svg.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -10 20 20").attr("refX",6).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("path").attr("d","M0,10 L10,0 L0,-10").attr("fill","#000"),this.svg=svg,this.width=width,this.height=height,this.data=data,this.cur=cur,this.redraw(),this.colorCur()}LinkedList.prototype.colorCur=function(){var that=this;this.svg.selectAll(".node").style("fill",function(d,i){return i===that.cur?"orange":"white"})},LinkedList.prototype.curInit=function(){this.cur=0,this.colorCur()},LinkedList.prototype.next=function(){this.cur<this.data.length-1&&(this.cur++,this.colorCur())},LinkedList.prototype.insertCur=function(val){this.cur>=this.data.length||this.addNode(this.cur+1,val)},LinkedList.prototype.deleteCur=function(){0===this.cur||this.cur>=this.data.length||this.deleteNode(this.cur)},LinkedList.prototype.setDataCur=function(val){this.setData(this.cur,val)},LinkedList.prototype.pushBack=function(val){this.addNode(this.data.length,val)},LinkedList.prototype.pushFront=function(val){this.addNode(1,val)},LinkedList.prototype.popBack=function(){this.deleteNode(this.data.length-1)},LinkedList.prototype.popFront=function(){this.deleteNode(1)},LinkedList.prototype.addNode=function(idx,val){var that=this,duration=500;this.data.length===idx||0===this.data.length?(this.addNodeAniOpacity(idx,val,duration),setTimeout(function(){that.colorCur()},duration)):(this.addNodeAniMove(idx,val,duration),setTimeout(function(){that.addNodeAniOpacity(idx,val,duration)},duration),setTimeout(function(){that.colorCur()},2*duration))},LinkedList.prototype.addNodeAniMove=function(idx,val,dur){this.svg.selectAll(".node").transition().duration(dur).attr("x",function(d,i){return i<idx?80*i:80*(i+1)}),this.svg.selectAll(".text").transition().duration(dur).attr("x",function(d,i){return i<idx?80*i+15:80*(i+1)+15}),this.svg.selectAll(".arrow").transition().duration(dur).attr("transform",function(d,i){return i<idx?"translate("+80*i+",15)":"translate("+80*(i+1)+",15)"})},LinkedList.prototype.addNodeAniOpacity=function(idx,val,dur){this.data.splice(idx,0,val),this.redraw(),this.svg.selectAll(".node").attr("opacity",function(d,i){return i===idx?0:1}).transition().duration(dur).attr("opacity",1),this.svg.selectAll(".text").attr("opacity",function(d,i){return i===idx?0:1}).transition().duration(dur).attr("opacity",1)},LinkedList.prototype.deleteNode=function(idx){var that=this,duration=500;this.data.length-1===idx||1===this.data.length?(this.deleteNodeAniOpacity(idx,duration),this.deleteNodeFinal(idx,duration)):(this.deleteNodeAniOpacity(idx,duration),setTimeout(function(){that.deleteNodeAniMove(idx,duration)},duration),this.deleteNodeFinal(idx,2*duration))},LinkedList.prototype.deleteNodeFinal=function(idx,delay){var that=this;setTimeout(function(){that.data.splice(idx,1),that.redraw(),that.colorCur()},delay)},LinkedList.prototype.deleteNodeAniMove=function(idx,dur){this.svg.selectAll(".node").transition().duration(dur).attr("x",function(d,i){return i>idx?80*(i-1):80*i}),this.svg.selectAll(".text").transition().duration(dur).attr("x",function(d,i){return i>idx?80*(i-1)+15:80*i+15}),this.svg.selectAll(".arrow").transition().duration(dur).attr("transform",function(d,i){return i>=idx?"translate("+80*(i-1)+",15)":"translate("+80*i+",15)"})},LinkedList.prototype.deleteNodeAniOpacity=function(idx,dur){this.svg.selectAll(".node").transition().duration(dur).attr("opacity",function(d,i){return i===idx?0:1}),this.svg.selectAll(".text").transition().duration(dur).attr("opacity",function(d,i){return i===idx?0:1}),this.svg.selectAll(".arrow").transition().duration(dur).attr("opacity",function(d,i){return i===idx?0:1})},LinkedList.prototype.setData=function(idx,val){this.data[idx]=val,this.svg.selectAll(".text").data(this.data).text(function(d){return d})},LinkedList.prototype.clear=function(){this.clearSVG(),this.data=["head"],this.cur=0,this.redraw(),this.colorCur()},LinkedList.prototype.clearSVG=function(){this.svg.selectAll(".node").remove(),this.svg.selectAll(".text").remove(),this.svg.selectAll(".arrow").remove()},LinkedList.prototype.redraw=function(){this.clearSVG(),this.svg.selectAll(".node").data(this.data).enter().append("rect").attr("class","node").attr("x",function(d,i){return 80*i}).attr("y",0).attr("width",30).attr("height",30).attr("opacity",1),this.svg.selectAll(".text").data(this.data).enter().append("text").attr("class","text").attr("x",function(d,i){return 80*i+15}).attr("y",15).attr("text-anchor","middle").attr("alignment-baseline","central").attr("opacity",1).text(function(d){return d}),this.svg.selectAll(".arrow").data(this.data.slice(0,-1)).enter().append("path").attr("class","arrow").attr("transform",function(d,i){return"translate("+80*i+",15)"}).attr("d","M40,0 L70,0").style("marker-end","url(#arrow)").style("stroke","black").style("stroke-width","3px").attr("opacity",1)},thisplay.LinkedList=LinkedList}(thisplay,d3),function(thisplay,d3){"use strict";function Matrix(target){var svg=d3.select(target).append("g").attr("class","thisplay-matrix").attr("transform","translate(25, 25)"),width=500,data=[],zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),this.svg=svg,this.width=width,this.rectSize=0,this.data=data}Matrix.prototype.init=function(row,col){this.rectSize=Math.ceil(this.width/col),this.data=new Array(row);for(var r=0;r<row;r++){this.data[r]=new Array(col);for(var c=0;c<col;c++)this.data[r][c]={text:"",color:"#000000",background:"#f2f2f2"}}this.redrawMatrix()},Matrix.prototype.redrawMatrix=function(){this.clear();var rectSize=this.rectSize,ele=this.svg.append("g").attr("class","matrix"),cells=ele.selectAll(".row").data(this.data).enter().append("g").attr("class","row").attr("id",function(d,i){return"rowIdx_"+i}).attr("transform",function(d,i){return"translate(0,"+rectSize*i+")"}).selectAll("g.g").data(function(d){return d}).enter().append("g").attr("class","cell").attr("id",function(d,i){return"colIdx_"+i}).attr("background","red").attr("transform",function(d,i){return"translate("+rectSize*i+",0)"}).attr("width",rectSize).attr("height",rectSize);cells.append("rect").attr("stroke","#111111").attr("fill",function(d){return d.background}).attr("x",0).attr("y",0).attr("width",rectSize).attr("height",rectSize),cells.append("text").attr("x",rectSize/2).attr("y",rectSize/2).attr("text-anchor","middle").attr("font-size",parseInt(rectSize/3)+"px").attr("dy",".35em").attr("width",rectSize).attr("height",rectSize).attr("fill",function(d){return d.color}).text(function(d){return d.text})},Matrix.prototype.clear=function(){this.svg.selectAll(".matrix").remove()},Matrix.prototype.setData=function(row,col,val){this.data[row][col].text=val,this.svg.select("#rowIdx_"+row+" #colIdx_"+col+" text").text(val)},Matrix.prototype.highlight=function(row,col,color){this.data[row][col].background=color,this.svg.select("#rowIdx_"+row+" #colIdx_"+col+" rect").transition().attr("fill",color)},Matrix.prototype.unhighlight=function(row,col){this.data[row][col].background="#f2f2f2",this.svg.select("#rowIdx_"+row+" #colIdx_"+col+" rect").attr("fill","#f2f2f2")},Matrix.prototype.unhighlightAll=function(){this.svg.selectAll(".cell rect").attr("fill","#f2f2f2")},Matrix.prototype.unhighlightColor=function(color){this.svg.selectAll(".cell rect").attr("fill",function(d,i){return d.background===color&&(d.background="#f2f2f2"),d.background})},thisplay.Matrix=Matrix}(thisplay,d3),function(thisplay,d3){"use strict";function Queue(target){var queue,svg=d3.select(target).append("g").attr("class","thisplay-chart").attr("transform","translate(25, 25)"),queueData=[],front=0,rear=0,rectWidth=80,rectHeight=80,padding=5,popCount=0,zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),this.container=svg,this.target=target,this.queue=queue,this.queueData=queueData,this.front=front,this.rear=rear,this.rectWidth=rectWidth,this.rectHeight=rectHeight,this.padding=padding,this.popCount=popCount;var that=this;this.mouseOver=function(d,i){d3.select("#rectIdx"+i).attr("fill","#FA812F").attr("width",1.1*that.rectWidth).attr("height",1.1*that.rectHeight).attr("transform","translate("+.05*-that.rectHeight+","+.05*-that.rectWidth+")"),that.queue.append("text").text("↑").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("id","arrow").attr("x",function(){return 100+(that.rectWidth+that.padding)*i+that.rectWidth/2}).attr("y",function(){return 300+1.3*that.rectHeight}),that.queue.append("text").text(function(){return"queue["+(i+that.popCount)+"] = "+that.queueData[i]}).attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("id","arrInfo").attr("x",function(){return 100+(that.rectWidth+that.padding)*i+that.rectWidth/2}).attr("y",function(){return 300+1.6*that.rectHeight})},this.mouseOut=function(d,i){d3.select(this).attr("fill","#FAAF08").attr("width",that.rectWidth).attr("height",that.rectHeight).attr("transform","translate(0,0)"),d3.select("#arrInfo").remove(),d3.select("#arrow").remove()}}Queue.prototype.push=function(_value){var newElem;this.rear++,this.queueData.push(_value);var position=(this.rectWidth+this.padding)*(this.rear-this.front-1)+100,distance=300,that=this;newElem=this.container.append("g"),newElem.append("rect").attr("x",position+distance).attr("y",300).attr("width",this.rectWidth).attr("height",this.rectHeight).attr("fill","#FAAF08").attr("rx",10).attr("ry",10),newElem.append("text").text(_value).attr("x",function(){return position+distance+that.rectWidth/2}).attr("y",function(){return 300+that.rectHeight/5*3}).attr("fill","black").attr("font-family","Consolas").attr("font-size","20px").attr("text-anchor","middle"),newElem.transition().duration(300).attr("transform","translate("+-distance+",0)").ease(d3.easeSinOut),setTimeout(function(){newElem.remove().exit(),that.drawQueue()},300)},Queue.prototype.pop=function(){var that=this;if(this.front!=this.rear){this.popCount++;var newElem,_value=this.queueData[0];this.front++,this.queueData=this.queueData.slice(1,this.queueData.length),this.drawQueue();var position=(this.rectWidth+this.padding)*-1+100,distance=300;newElem=this.container.append("g"),newElem.append("rect").attr("x",position).attr("y",300).attr("width",this.rectWidth).attr("height",this.rectHeight).attr("fill","#FAAF08").attr("rx",10).attr("ry",10),newElem.append("text").text(_value).attr("x",function(){return position+that.rectWidth/2}).attr("y",function(){return 300+that.rectHeight/5*3}).attr("fill","black").attr("font-family","Consolas").attr("font-size","20px").attr("text-anchor","middle"),newElem.transition().duration(300).attr("transform","translate("+-distance+",0)").ease(d3.easeSinOut),setTimeout(function(){newElem.remove().exit(),that.drawQueue()},300)}},Queue.prototype.clear=function(){for(;this.front<this.rear;)this.pop()},Queue.prototype.init=function(){this.clear(),this.front=0,this.rear=0,this.popCount=0,this.drawQueue()},Queue.prototype.drawQueue=function(){var that=this;return void 0!==this.queue&&this.queue.remove().exit(),this.queue=this.container.append("g"),0===this.queueData.length?(this.queue.append("text").text("▼▼").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+that.rectWidth/2}).attr("y",function(){return 300-.2*that.rectHeight}),this.queue.append("text").text("front").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+that.rectWidth/2}).attr("y",function(){return 300-.5*that.rectHeight}),void this.queue.append("text").text("rear").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+(that.rectWidth+that.padding)*(that.rear-that.front)+that.rectWidth/2}).attr("y",function(){return 300-.8*that.rectHeight})):(this.queue.selectAll("g.rect").data(this.queueData).enter().append("rect").attr("x",function(d,i){return 100+(that.rectWidth+that.padding)*i}).attr("y",300).attr("width",this.rectWidth).attr("height",this.rectHeight).attr("rx",10).attr("ry",10).attr("fill","#FAAF08").attr("id",function(d,i){return"rectIdx"+i}).attr("opacity",1).on("mouseover",this.mouseOver).on("mouseout",this.mouseOut),this.queue.selectAll("g.text").data(this.queueData).enter().append("text").text(function(d,i){return d}).attr("x",function(d,i){return 100+(that.rectWidth+that.padding)*i+that.rectWidth/2}).attr("y",function(){return 300+that.rectHeight/5*3}).attr("fill","black").attr("font-family","Consolas").attr("font-size","20px").attr("text-anchor","middle").attr("id",function(d,i){return"textIdx"+i}),this.queue.append("text").text("▼").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+that.rectWidth/2}).attr("y",function(){return 300-.2*that.rectHeight}),this.queue.append("text").text("front").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+that.rectWidth/2}).attr("y",function(){return 300-.5*that.rectHeight}),this.queue.append("text").text("▼").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+(that.rectWidth+that.padding)*(that.rear-that.front)+that.rectWidth/2}).attr("y",function(){return 300-.2*that.rectHeight}),void this.queue.append("text").text("rear").attr("font-family","Consolas").attr("font-size","20px").attr("fill","black").attr("text-anchor","middle").attr("x",function(){return 100+(that.rectWidth+that.padding)*(that.rear-that.front)+that.rectWidth/2}).attr("y",function(){return 300-.5*that.rectHeight}))},thisplay.Queue=Queue}(thisplay,d3),function(thisplay,d3){"use strict";function Stack(target){var lineData,svg=d3.select(target).append("g").attr("class","thisplay-stack").attr("transform","translate(25, 25)"),width=500,height=300,data=[],zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),this.svg=svg,this.width=width,this.height=height,this.data=data,this.rectHeight=40,this.rectWidth=70,this.padding=this.rectHeight/10,this.top=-1,lineData=[{x:(width-this.rectWidth-4*this.padding)/2,y:this.padding},{x:(width-this.rectWidth-4*this.padding)/2,y:height/2},{x:(width-this.rectWidth-4*this.padding)/2,y:height},{x:(width-this.rectWidth-4*this.padding)/2,y:height+this.padding},{x:(width+this.rectWidth+4*this.padding)/2,y:height+this.padding},{x:(width+this.rectWidth+4*this.padding)/2,y:height},{x:(width+this.rectWidth+4*this.padding)/2,y:height/2},{x:(width+this.rectWidth+4*this.padding)/2,y:this.padding}];var lineFunc=d3.line().x(function(d){return d.x}).y(function(d){return d.y}).curve(d3.curveCatmullRom,1);svg.append("path").attr("d",lineFunc(lineData)).attr("stroke","#C6B2BB").attr("stroke-width","2").attr("fill","none").attr("id","stackLine");var lineLength=d3.select("#stackLine").node().getTotalLength();d3.select("#stackLine").attr("stroke-dasharray",lineLength).attr("stroke-dashoffset",lineLength).transition().duration(1e3).attr("stroke-dashoffset",0);var that=this;this.mouseOver=function(d,i){d3.select("#elemIdx_"+i).attr("fill","#D3C4BE").attr("width",1.1*that.rectWidth).attr("height",1.1*that.rectHeight).attr("transform","translate("+.05*-that.rectWidth+","+.05*-that.rectHeight+")"),that.svg.append("text").text("←").attr("font-family","Arial").attr("font-size",that.rectHeight/2+"px").attr("fill",that.data[i].color).attr("text-anchor","middle").attr("id","arrow").attr("x",that.width/2+that.rectWidth/2+10).attr("y",that.height-(that.rectHeight+that.padding)*(i+1)+that.rectHeight/3*2),that.svg.append("text").text(function(){return"stack["+i+"] = "+that.data[i].text}).attr("x",that.width/2+that.rectWidth/2+10+that.rectHeight/2).attr("y",that.height-(that.rectHeight+that.padding)*(i+1)+that.rectHeight/3*2).attr("font-family","Arial").attr("font-size",that.rectHeight/2+"px").attr("fill",that.data[i].color).attr("id","stackInfo")},this.mouseOut=function(d,i){d3.select(this).attr("fill",that.data[i].background).attr("width",that.rectWidth).attr("height",that.rectHeight).attr("transform","translate(0,0)"),d3.select("#arrow").remove(),d3.select("#stackInfo").remove()}}Stack.prototype.init=function(size){this.clear(),size&&(this.top=-1,size<7&&(this.rectHeight=Math.ceil(this.height/(size+size/10)),this.padding=this.rectHeight/10))},Stack.prototype.redrawStack=function(){var that=this;this.svg.selectAll(".stack").remove();var rectWidth,rectHeight,ele=this.svg.append("g").attr("class","stack");this.top>=5&&(this.rectHeight=Math.ceil(this.height/(this.top+3+(this.top+3)/10)),this.padding=this.rectHeight/10),rectWidth=this.rectWidth,rectHeight=this.rectHeight;var cells=ele.selectAll(".elem").data(this.data).enter().append("g").attr("class","elem");cells.append("rect").attr("fill",function(d){return d.background}).attr("x",that.width/2-rectWidth/2).attr("y",function(d,i){return that.height-(rectHeight+that.padding)*(i+1)}).attr("width",rectWidth).attr("height",rectHeight).attr("rx",2).attr("ry",2).attr("id",function(d,i){return"elemIdx_"+i}).on("mouseover",this.mouseOver).on("mouseout",this.mouseOut),cells.append("text").attr("x",that.width/2).attr("y",function(d,i){return that.height-(rectHeight+that.padding)*(i+1)+rectHeight/3*2}).attr("text-anchor","middle").attr("font-family","Arial").attr("font-size",function(d){return rectHeight/3+"px"}).attr("fill",function(d){return d.color}).text(function(d){return d.text})},Stack.prototype.push=function(val){var that=this;this.top++,this.data[this.top]={text:val,color:"#4F474A",background:"#EBCFC4"},this.svg.select("#elemIdx_"+this.top+" text").text(val);var distance=this.height-(this.rectHeight+this.padding)*(this.top+1);this.top>5&&(distance=that.rectHeight-(that.height-(that.rectHeight+that.padding)*(this.top-1))+3*that.rectHeight);var newElem=this.svg.append("g");that.rectHeight/3;newElem.append("rect").attr("x",this.width/2-this.rectWidth/2).attr("y",0).attr("width",this.rectWidth).attr("height",this.rectHeight).attr("fill","white").attr("rx",2).attr("ry",2).attr("id","newElemRect"),newElem.append("text").text(val).attr("x",that.width/2).attr("y",that.rectHeight/3*2).attr("text-anchor","middle").attr("font-family","Arial").attr("font-size",that.rectHeight/3+"px").attr("fill","white").attr("id","newElemText"),d3.select("#newElemRect").transition().attr("fill",this.data[this.top].background).duration(300),d3.select("#newElemText").transition().attr("fill",this.data[this.top].color).duration(300),newElem.transition().attr("transform","translate(0,"+distance+")").duration(500).delay(300).ease(d3.easeSinOut),setTimeout(function(){newElem.remove().exit(),that.redrawStack()},700)},Stack.prototype.pop=function(){var top=this.top;if(!(top<0)){var val=this.data[top],newElem=this.svg.append("g"),that=this,distance=-(this.height-(this.rectHeight+this.padding)*this.top);this.top>5&&(distance=that.rectHeight-(that.height-(that.rectHeight+that.padding)*this.top)+3*that.rectHeight,distance*=-1),this.data.pop(),this.top--,this.redrawStack(),newElem.append("rect").attr("x",this.width/2-this.rectWidth/2).attr("y",that.height-(that.rectHeight+that.padding)*(top+1)).attr("width",this.rectWidth).attr("height",this.rectHeight).attr("fill",val.background).attr("rx",2).attr("ry",2),newElem.append("text").text(val.text).attr("x",that.width/2).attr("y",that.rectHeight/3*2+that.height-(that.rectHeight+that.padding)*(top+1)).attr("text-anchor","middle").attr("font-family","Arial").attr("font-size",that.rectHeight/3+"px").attr("fill",val.color),newElem.transition().attr("transform","translate(0,"+distance+")").duration(500).ease(d3.easeSinOut),setTimeout(function(){newElem.remove().exit()},300)}},Stack.prototype.clear=function(){this.svg.selectAll(".stack").remove(),this.top=-1,this.data=[]},Stack.prototype.setData=function(idx,val){this.data[idx].text=val,this.svg.select("#elemIdx_"+idx+" text").text(val)},Stack.prototype.highlight=function(row,col,color){this.data[row][col].background=color,this.svg.select("#rowIdx_"+row+" #colIdx_"+col+" rect").transition().attr("fill",color)},Stack.prototype.unhighlight=function(row,col){this.data[row][col].background="#f2f2f2",this.svg.select("#rowIdx_"+row+" #colIdx_"+col+" rect").attr("fill","#f2f2f2")},Stack.prototype.unhighlightAll=function(){
this.svg.selectAll(".cell rect").attr("fill","#f2f2f2")},Stack.prototype.unhighlightColor=function(color){this.svg.selectAll(".cell rect").attr("fill",function(d,i){return d.background===color&&(d.background="#f2f2f2"),d.background})},thisplay.Stack=Stack}(thisplay,d3),function(window,d3){"use strict";function Tree(target){d3=d3||window.d3;var svg=d3.select(target).append("g").attr("class","thisplay-tree").attr("transform","translate(25, 25)"),data=[],treeWidth=60,treeHeight=80,zoom=d3.zoom().scaleExtent([.1,10]).on("zoom",function(){svg.attr("transform",d3.event.transform)});d3.select(target).call(zoom),this.svg=svg,this.data=data,this.treeWidth=treeWidth,this.treeHeight=treeHeight,this.beforeTreeWidth=0}Tree.prototype.makeNode=function(id,val){this.data.push({val:val,id:id,par:-1,children:[]}),this.redraw()},Tree.prototype.findNode=function(node,id){var that=this;if(node.id===id)return node;var ret;return node.children.forEach(function(d){var temp=that.findNode(d,id);temp&&(ret=temp)}),ret},Tree.prototype.connect=function(parId,childId){var par,parIdx,childIdx,duration=1e3,that=this;this.data.forEach(function(d,i){d.id===childId&&(childIdx=i)});for(var i=0;i<this.data.length;i++)if(i!==childIdx&&(par=this.findNode(this.data[i],parId))){parIdx=i;break}return par&&void 0!==childIdx?(par.children.push(this.data[childIdx]),this.data.splice(childIdx,1),this.connectAni(parIdx,childIdx,duration),void setTimeout(function(){that.redraw()},duration)):(console.log("no id"),console.log(par),void console.log(childIdx))},Tree.prototype.connectAni=function(parIdx,childIdx,duration){this.redrawTrans(duration,parIdx),this.svg.selectAll(".trees").transition().duration(duration).attr("opacity",function(d,i){return i===childIdx||i===parIdx?0:1})},Tree.prototype.maxDepth=function(root){var that=this,max=root.depth;return root.children?(root.children.forEach(function(d){var temp=that.maxDepth(d);temp>max&&(max=temp)}),max):max},Tree.prototype.numLeaf=function(root){var ret=0,that=this;return root.children?(root.children.forEach(function(d){var temp=that.numLeaf(d);ret+=temp}),ret):1},Tree.prototype.redrawTrans=function(duration,idx){var that=this;this.beforeTreeWidth=0,console.log(idx),this.data.forEach(function(data,i){var maxDepth=0,tree=d3.tree(),nodes=d3.hierarchy(data,function(d){return d.children});maxDepth=that.maxDepth(nodes);var numLeaf=that.numLeaf(nodes);tree.size([that.treeWidth*numLeaf,that.treeHeight*maxDepth]),nodes=tree(nodes);var g=that.svg.append("g").attr("class","trees").attr("opacity",1).attr("transform",function(){return"translate("+that.beforeTreeWidth+",0)"});if(that.beforeTreeWidth+=that.treeWidth*numLeaf,void 0===idx||idx===i){var link=g.selectAll(".link").data(nodes.descendants().slice(1));link.enter().append("path").attr("class","link").attr("opacity",0).attr("d",function(d){return"M"+d.x+","+d.y+"C"+d.x+","+(d.y+d.parent.y)/2+" "+d.parent.x+","+(d.y+d.parent.y)/2+" "+d.parent.x+","+d.parent.y}).transition().duration(duration).attr("opacity",1);var node=g.selectAll(".node").data(nodes.descendants()),nodeEnter=node.enter().append("g").attr("class","node").attr("opacity",0).attr("transform",function(d){return"translate("+d.x+","+d.y+")"});nodeEnter.append("circle").attr("r",20),nodeEnter.append("text").attr("text-anchor","middle").attr("alignment-baseline","central").text(function(d){return d.data.val}),nodeEnter.transition().duration(duration).attr("opacity",1)}})},Tree.prototype.redraw=function(){this.clearSVG(),this.redrawTrans(0)},Tree.prototype.clear=function(){this.data=[],this.redraw()},Tree.prototype.clearSVG=function(){this.svg.selectAll(".trees").remove()},window.thisplay.Tree=Tree}(window,window.d3);